/*
 * mod_autoindex v1.3.2
 * (c) hex7c0 http://supergiovane.tk/#/mod_autoindex
 * Licensed under GPLv3
 */
"use strict";function multiple(a,b){var c="";if(a>b)return c;for(var d=0;b-a>d;d++)c+=" ";return c}function pad(a){var b=Math.abs(Math.floor(a));return(10>b?"0":"")+b}function wrapper(a){function b(b,c,d){return a.static(b,c,d)}return function(c,d,e){if(a.strictMethod&&"GET"!=c.method&&"HEAD"!=c.method)return b(c,d,e);var f=parse(c).pathname,g=a.root+f;fs.stat(g,function(h,i){if(h)return b(c,d,e);if(!i.isDirectory())return b(c,d,e);var j=header;j=j.replace(/{{path}}/g,f),"/"!=f&&(j+='<a href="../">../</a>\n'),fs.readdir(g,function(f,h){if(f)return b(c,d,e);var i="";h.forEach(function(b){if(!(a.exclude&&a.exclude.test(b)||a.dotfiles&&"."==b[0])){var c,d,e=fs.statSync(g+"/"+b),f=new Date(e.mtime);e.isDirectory()?(d="-",b+="/"):d=String(e.size),c='<a href="'+b+'">'+b+"</a>",c+=multiple(b.length,50),a.date&&(c+=pad(f.getDate())+"-"+month[f.getMonth()]+"-"+f.getFullYear(),c+=" "+pad(f.getHours())+":"+pad(f.getMinutes()),c+=multiple(d.length,20)),a.size&&(c+=d),c+="\n",a.priority?"-"==d?j+=c:i+=c:j+=c}}),j+=i,d.send(j+footer)})})}}try{var fs=require("fs"),resolve=require("path").resolve,parse=require("parseurl"),serve=require("serve-static")}catch(MODULE_NOT_FOUND){console.error(MODULE_NOT_FOUND),process.exit(1)}var header='<html>\n<head><title>Index of {{path}}</title></head>\n<body bgcolor="white">\n<h1>Index of {{path}}</h1><hr><pre>\n',footer="</pre><hr></body>\n</html>\n",month=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];module.exports=function(a,b){if(!a)throw new TypeError("root path required");if(!fs.existsSync(a))throw new Error("path not exists");if(!fs.statSync(a).isDirectory())throw new Error("path is not a directory");var c=resolve(a);"/"==a[a.length-1]&&(c=a.substr(0,a.length-1));var b=b||Object.create(null),d={root:c,exclude:b.exclude||!1,dotfiles:0==b.dotfiles?!1:!0,date:0==b.date?!1:!0,size:0==b.size?!1:!0,priority:0==b.priority?!1:!0,strictMethod:Boolean(b.strictMethod),"static":0==b.static?function(a,b,c){return c()}:serve(c,b.static)};return wrapper(d)};
